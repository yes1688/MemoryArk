# MemoryArk AI 助理指南

## 🚨 絕對禁令 (必須遵守)

- 🚫 **禁止刪除數據**：永不建議 `rm -rf data/*` 或 `DROP DATABASE`
- 🚫 **禁止跳過認證**：遇到 Cloudflare Access 必須修復，不得繞過
- 🚫 **禁止假數據**：所有統計必須基於真實 API 響應

## ✅ 強制操作流程

1. **容器部署**：修改後執行 `podman-compose down && podman-compose up -d`
2. **前端建構**：在 host 執行 `npm run build`，產生 `dist/` 供容器使用
3. **認證問題**：必須完整修復，不可繞過或停用 Cloudflare Access
4. **任務協作**：查看並更新 `TASK_COORDINATION.md` 狀態

## 📁 專案基本資訊

- **技術棧**：Vue 3 + TypeScript + Go + SQLite + Podman + Node.js (LINE Service)
- **管理員**：<94work.net@gmail.com> (劉程維)
- **設計原則**：賈伯斯理念 + Apple HIG + Windows 11 Fluent Design
- **LINE 功能**：line.94work.net (port 7002) - 信徒照片上傳服務

## 🔧 開發規範

- 使用 TypeScript 嚴格模式，組件放在 `src/components/ui/[component-name]/`
- API 共用優先，使用 Tailwind CSS 教會配色（深藍+金色）
- 使用 TodoWrite 追蹤複雜任務

## 🧠 MCP 知識庫使用規範 (Claude 必讀)

### ⚡ 對話開始必做 (強制執行)

**每次對話開始，立即執行以下搜尋**：
1. 🔍 `qdrant-find "MemoryArk2 + [當前討論主題]"`
2. 🔍 `qdrant-find "[技術關鍵字] + 實作經驗"`
3. 🔍 `qdrant-find "[問題類型] + 解決方案"`

**顯示搜尋結果摘要**：
- 找到 X 個相關記錄
- 最相關的 3 個歷史經驗
- 需要注意的關鍵事項

### 🎯 工作中自動觸發 (關鍵字偵測)

**遇到這些詞彙時，立即搜尋知識庫**：
- 「架構設計」→ 搜尋相關架構模式
- 「技術選型」→ 搜尋選型經驗與理由
- 「問題解決」→ 搜尋類似問題案例
- 「最佳實務」→ 搜尋實務指南
- 「部署配置」→ 搜尋部署相關經驗

**遇到這些詞彙時，立即記錄到知識庫**：
- 「決定使用」→ 記錄技術選型決策
- 「解決方案」→ 記錄問題解決過程
- 「配置如下」→ 記錄配置範本
- 「學到了」→ 記錄經驗教訓
- 「避免」→ 記錄反模式警告

### 📝 記錄標準格式 (qdrant-store)

```
標題: [技術/問題] - [簡潔描述] 
內容:
## 背景
[問題描述或需求背景]

## 解決方案
[具體實作方法或決策]

## 關鍵理由
[為什麼選擇這個方案]

## 結果/學習
[實際效果或重要發現]

## 相關標籤
技術棧: [Vue3/Go/Docker等]
專案: MemoryArk2
類型: [架構/實作/問題解決/配置]
```

### 🔍 搜尋策略指南

**有效的搜尋查詢範例**：
- `"MemoryArk2 容器化 問題"` - 專案特定問題
- `"Vue3 TypeScript 最佳實務"` - 技術棧實務
- `"Nginx 反向代理 配置"` - 具體技術配置
- `"架構決策 微服務 vs 單體"` - 設計模式比較

**多層次搜尋策略**：
1. 先搜尋專案特定經驗
2. 再搜尋技術棧通用模式  
3. 最後搜尋抽象設計原則

### 🔄 對話結束必做

**每次對話結束前**：
1. 檢視今日產生的重要決策/解決方案
2. 將有價值的內容記錄到知識庫
3. 建立與相關記錄的連結
4. 為下次對話建立連接點

### 📋 執行檢查清單

**對話開始時**：
- [ ] 執行 3 個初始搜尋
- [ ] 顯示找到的相關知識數量
- [ ] 識別可能的知識缺口

**工作過程中**：
- [ ] 偵測觸發關鍵字
- [ ] 主動搜尋相關經驗
- [ ] 即時記錄重要發現

**對話結束時**：
- [ ] 總結新增的知識
- [ ] 記錄未來參考要點
- [ ] 建立知識連結

## 🚀 任務分配協作

### 📋 工作流程
1. **認領任務**：在 `line_docs/tasks/TASK_TRACKING.md` 更新負責者和狀態
2. **開始工作**：按照 `line_docs/` 中的詳細實作指南執行
3. **提交更改**：完成後立即提交，避免衝突
4. **更新狀態**：同步更新 TodoWrite 和 Markdown 檔案狀態

## 🐳 容器管理

- **強制使用 Podman**：安全性優於 Docker
- **數據目錄**：`data/`（資料庫）、`uploads/`（檔案）- 極度珍貴！
- **雙 Nginx 架構**：主系統 (port 7001) + LINE 服務 (port 7002)
- **LINE 部署**：修改後執行 `podman-compose down && podman-compose up -d`

## 🚨 慘痛教訓 (2025-06-10)

**AI 差點建議 `rm -rf data/*`** - 感謝 <94work.net@gmail.com> 及時制止！

---

數據完整性 > 技術便利性 > 開發效率