# 📋 測試計畫：檔案管理系統性能優化驗證

## 🎯 測試目標
驗證剛才修復的三個關鍵問題是否解決：
1. 重複 API 調用
2. Worker 就緒狀態
3. 組件重複初始化

## 📊 測試步驟

### **第一階段：基礎功能測試**

#### 1. 刷新頁面載入測試
- 🔍 **觀察點**：初始載入的 console 日誌
- ✅ **期望結果**：
  - 只有一次 `updateScreenSize` 調用
  - Worker 顯示 `workerReady: true`
  - 沒有重複的初始化日誌

**測試記錄：**
```
操作：重新整理頁面 (F5)
實際結果：
[請貼上 console 日誌]

是否符合期望：✅ / ❌
備註：
```

#### 2. 根目錄檔案列表測試
- 🔍 **觀察點**：`/files` 頁面的載入
- ✅ **期望結果**：
  - 單次 `fetchFiles` 調用（如果有 cache miss）
  - Worker 狀態正常

**測試記錄：**
```
操作：訪問 /files 頁面
實際結果：
[請貼上 console 日誌]

是否符合期望：✅ / ❌
備註：
```

### **第二階段：導航功能測試**

#### 3. 點擊資料夾進入測試
- 📝 **操作**：點擊 `level1` 資料夾
- 🔍 **觀察點**：console 中的 API 調用次數
- ✅ **期望結果**：
  - 只有一次 `🗄️ Cache MISS` 或 `🗄️ Cache HIT`
  - 只有一次 `📂 fetchFiles API Call`（如果 cache miss）
  - 沒有重複的 `fetchFiles` 調用

**測試記錄：**
```
操作：點擊 level1 資料夾
實際結果：
[請貼上 console 日誌]

是否符合期望：✅ / ❌
備註：
```

#### 4. 深層導航測試
- 📝 **操作**：level1 → level2-1 → level3-2
- 🔍 **觀察點**：每一層的 API 調用
- ✅ **期望結果**：
  - 每層最多一次 API 調用
  - 快取命中時跳過 API 調用

**測試記錄：**
```
操作：level1 → level2-1 → level3-2 逐層點擊
實際結果：
[請貼上 console 日誌]

是否符合期望：✅ / ❌
備註：
```

### **第三階段：麵包屑導航測試**

#### 5. 麵包屑返回測試
- 📝 **操作**：從 level3-2 點擊麵包屑回到 level1
- 🔍 **觀察點**：路由變化和 API 調用
- ✅ **期望結果**：
  - 路徑檢查生效：`🔄 已在目標路徑，跳過麵包屑導航`
  - 或使用快取：`🎯 navigateToFolder 使用快取檔案列表`

**測試記錄：**
```
操作：從 level3-2 點擊麵包屑回到 level1
實際結果：
[請貼上 console 日誌]

是否符合期望：✅ / ❌
備註：
```

#### 6. 麵包屑重複點擊測試
- 📝 **操作**：連續點擊同一個麵包屑項目
- 🔍 **觀察點**：是否有重複處理
- ✅ **期望結果**：
  - 第一次後的點擊被跳過
  - 不觸發重複的路由變化

**測試記錄：**
```
操作：連續點擊同一個麵包屑項目
實際結果：
[請貼上 console 日誌]

是否符合期望：✅ / ❌
備註：
```

### **第四階段：Worker 功能測試**

#### 7. Worker 預載功能測試
- 📝 **操作**：正常瀏覽檔案系統
- 🔍 **觀察點**：Worker 相關日誌
- ✅ **期望結果**：
  - 不再看到 `⚠️ Worker 未就緒，跳過預載`
  - 看到 Worker 預載相關的日誌

**測試記錄：**
```
操作：正常瀏覽多個資料夾
實際結果：
[請貼上 console 日誌]

是否符合期望：✅ / ❌
備註：
```

#### 8. 快取效果測試
- 📝 **操作**：訪問資料夾 → 離開 → 15分鐘內重新訪問
- 🔍 **觀察點**：快取命中情況
- ✅ **期望結果**：
  - 第二次訪問顯示 `🗄️ Cache HIT`
  - TTL 900000ms (15分鐘) 生效

**測試記錄：**
```
操作：重複訪問同一資料夾
實際結果：
[請貼上 console 日誌]

是否符合期望：✅ / ❌
備註：
```

## 🚨 重點關注的日誌訊息

### **好的訊息（希望看到）：**
- `✅ Worker 快取系統標記為已初始化 {workerReady: true, healthy: true}`
- `🗄️ Cache HIT: files:xxx`
- `🎯 navigateToFolder 使用快取檔案列表`
- `🔄 已在目標路徑，跳過麵包屑導航`
- `[useWebWorker] Worker ready:`

### **問題訊息（不應該看到）：**
- `⚠️ Worker 未就緒，跳過預載`
- 重複的 `📂 fetchFiles API Call` 對同一個資料夾
- 重複的 `🖥️ Screen size updated`
- `🗄️ Cache MISS` 對剛剛訪問過的資料夾

## 📝 測試結果總結

### 整體評估
```
性能改善情況：
[ ] 明顯改善
[ ] 略有改善  
[ ] 無明顯變化
[ ] 有所退步

使用體驗：
[ ] 檔案瀏覽更流暢
[ ] 載入速度提升
[ ] 導航響應更快
[ ] 無明顯差異
```

### 仍存在的問題
```
1. 
2. 
3. 
```

### 建議後續優化方向
```
1. 
2. 
3. 
```

## 🎯 測試完成檢查清單

- [ ] 第一階段：基礎功能測試完成
- [ ] 第二階段：導航功能測試完成  
- [ ] 第三階段：麵包屑導航測試完成
- [ ] 第四階段：Worker 功能測試完成
- [ ] 測試結果總結完成
- [ ] 問題清單整理完成

---

**測試執行日期：** `____年____月____日`  
**測試執行者：** `__________`  
**系統版本：** `MemoryArk 2.0.11`