<template>
  <div class="category-management">
    <!-- é é¢æ¨™é¡Œ -->
    <div class="page-header">
      <h1 class="page-title">æª”æ¡ˆåˆ†é¡ç®¡ç†</h1>
      <p class="page-subtitle">ç®¡ç†æª”æ¡ˆçš„åˆ†é¡æ–¹å¼ï¼Œæä¾›å¤šç¨®çµ„ç¹”æª”æ¡ˆçš„é¸é …</p>
    </div>

    <!-- åˆ†é¡ç³»çµ±å°æ¯” -->
    <div class="classification-comparison">
      <div class="comparison-grid">
        <!-- å‚³çµ±è³‡æ–™å¤¾ç³»çµ± -->
        <div class="classification-card">
          <div class="card-header">
            <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
              <path d="M10 4H4c-1.11 0-2 .89-2 2v12c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2h-8l-2-2z"/>
            </svg>
            <h2>è³‡æ–™å¤¾ç³»çµ±</h2>
          </div>
          <div class="card-content">
            <p class="description">å‚³çµ±æª”æ¡ˆç®¡ç†æ–¹å¼ï¼Œé©åˆå€‹äººåŒ–çµ„ç¹”</p>
            
            <div class="features">
              <h3>é©ç”¨å ´æ™¯ï¼š</h3>
              <ul>
                <li>æŒ‰å¹´ä»½çµ„ç¹”ï¼ˆ2024å¹´ã€2025å¹´ï¼‰</li>
                <li>æŒ‰æ´»å‹•åˆ†é¡ï¼ˆæ¯è¦ªç¯€ã€å¾©æ´»ç¯€ï¼‰</li>
                <li>æŒ‰éƒ¨é–€ç®¡ç†ï¼ˆé’å¹´åœ˜å¥‘ã€å©¦å¥³åœ˜å¥‘ï¼‰</li>
                <li>å€‹äººå°ˆæ¡ˆæª”æ¡ˆ</li>
              </ul>
            </div>
            
            <div class="example-structure">
              <h3>ç¯„ä¾‹çµæ§‹ï¼š</h3>
              <div class="folder-tree">
                <div class="folder">ğŸ“ 2024å¹´æ´»å‹•</div>
                <div class="folder level-1">ğŸ“ æ¯è¦ªç¯€</div>
                <div class="folder level-2">ğŸ“„ æ¯è¦ªç¯€æ´»å‹•ç…§ç‰‡.jpg</div>
                <div class="folder level-2">ğŸ“„ æ„Ÿæ©è¦‹è­‰å½±ç‰‡.mp4</div>
                <div class="folder level-1">ğŸ“ å¾©æ´»ç¯€</div>
                <div class="folder level-2">ğŸ“„ å¾©æ´»ç¯€è¦‹è­‰.docx</div>
              </div>
            </div>

            <div class="actions">
              <button @click="$router.push('/files')" class="action-btn primary">
                ç®¡ç†è³‡æ–™å¤¾
              </button>
            </div>
          </div>
        </div>

        <!-- æ•™æœƒç‰¹å®šåˆ†é¡ç³»çµ± -->
        <div class="classification-card">
          <div class="card-header">
            <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </svg>
            <h2>æ•™æœƒåˆ†é¡ç³»çµ±</h2>
          </div>
          <div class="card-content">
            <p class="description">å°ˆç‚ºæ•™æœƒè¨­è¨ˆçš„åˆ†é¡æ–¹å¼ï¼ŒåŸºæ–¼æ•™æœƒåŠŸèƒ½</p>
            
            <div class="features">
              <h3>æ•™æœƒå°ˆå±¬åˆ†é¡ï¼š</h3>
              <ul>
                <li>å®‰æ¯æ—¥è³‡æ–™ï¼ˆè¬›é“ã€è–è©©ï¼‰</li>
                <li>å…±äº«è³‡æºï¼ˆæ•™æã€è¡¨æ ¼ï¼‰</li>
                <li>è¦‹è­‰åˆ†äº«</li>
                <li>æ•™æœƒæ´»å‹•</li>
                <li>è¡Œæ”¿æ–‡ä»¶</li>
                <li>éŸ³æ¨‚è©©æ­Œ</li>
              </ul>
            </div>
            
            <div class="category-list">
              <h3>ç›®å‰åˆ†é¡ï¼š</h3>
              <div class="categories">
                <div class="category-item" v-for="category in categories" :key="category.id">
                  <div class="category-info">
                    <span class="category-name">{{ category.name }}</span>
                    <span class="category-count">{{ category.fileCount }} å€‹æª”æ¡ˆ</span>
                  </div>
                  <button @click="navigateToCategory(category.id)" class="view-btn">
                    æª¢è¦–
                  </button>
                </div>
              </div>
            </div>

            <div class="actions">
              <button @click="$router.push('/shared')" class="action-btn primary">
                æª¢è¦–å…±äº«è³‡æº
              </button>
              <button @click="$router.push('/sabbath')" class="action-btn secondary">
                æª¢è¦–å®‰æ¯æ—¥è³‡æ–™
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- å»ºè­°çš„æ··åˆä½¿ç”¨æ–¹å¼ -->
    <div class="recommendation-section">
      <h2>å»ºè­°çš„æª”æ¡ˆçµ„ç¹”ç­–ç•¥</h2>
      <div class="strategy-grid">
        <div class="strategy-card">
          <h3>ğŸ›ï¸ æ•™æœƒå®˜æ–¹æª”æ¡ˆ</h3>
          <p>ä½¿ç”¨<strong>æ•™æœƒåˆ†é¡ç³»çµ±</strong></p>
          <ul>
            <li>å®‰æ¯æ—¥è¬›é“ã€è–è©©</li>
            <li>å®˜æ–¹æ•™æå’Œè¡¨æ ¼</li>
            <li>è¡Œæ”¿æ–‡ä»¶</li>
          </ul>
        </div>
        
        <div class="strategy-card">
          <h3>ğŸ‘¥ å€‹äººæˆ–å°çµ„æª”æ¡ˆ</h3>
          <p>ä½¿ç”¨<strong>è³‡æ–™å¤¾ç³»çµ±</strong></p>
          <ul>
            <li>å€‹äººè¦‹è­‰å’Œåˆ†äº«</li>
            <li>å°çµ„æ´»å‹•ç…§ç‰‡</li>
            <li>å°ˆæ¡ˆç›¸é—œæª”æ¡ˆ</li>
          </ul>
        </div>
        
        <div class="strategy-card">
          <h3>ğŸ”„ æ··åˆä½¿ç”¨</h3>
          <p>å…©ç¨®ç³»çµ±<strong>ä¸¦å­˜</strong></p>
          <ul>
            <li>å…ˆç”¨æ•™æœƒåˆ†é¡å¤§åˆ†é¡</li>
            <li>å†ç”¨è³‡æ–™å¤¾ç´°åˆ†çµ„ç¹”</li>
            <li>éˆæ´»æ‡‰ç”¨å…©ç¨®æ–¹å¼</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, computed, onMounted } from 'vue'
import { useRouter } from 'vue-router'
import { useFilesStore } from '@/stores/files'

const router = useRouter()
const filesStore = useFilesStore()

// æ•™æœƒåˆ†é¡å®šç¾©
const categories = ref([
  { id: 1, name: 'å®‰æ¯æ—¥è³‡æ–™', fileCount: 0 },
  { id: 2, name: 'å…±äº«è³‡æº', fileCount: 0 },
  { id: 3, name: 'è¦‹è­‰åˆ†äº«', fileCount: 0 },
  { id: 4, name: 'æ•™æœƒæ´»å‹•', fileCount: 0 },
  { id: 5, name: 'è¡Œæ”¿æ–‡ä»¶', fileCount: 0 },
  { id: 6, name: 'éŸ³æ¨‚è©©æ­Œ', fileCount: 0 }
])

// è¨ˆç®—å„åˆ†é¡çš„æª”æ¡ˆæ•¸é‡
const updateCategoryCounts = () => {
  categories.value.forEach(category => {
    category.fileCount = filesStore.files.filter(file => 
      (file as any).categoryId === category.id && !file.isDeleted
    ).length
  })
}

// å°èˆªåˆ°ç‰¹å®šåˆ†é¡
const navigateToCategory = (categoryId: number) => {
  switch (categoryId) {
    case 1:
      router.push('/sabbath')
      break
    case 2:
      router.push('/shared')
      break
    default:
      // å¯ä»¥æ·»åŠ æ›´å¤šåˆ†é¡é é¢
      alert(`åˆ†é¡ ${categoryId} çš„å°ˆå±¬é é¢æ­£åœ¨é–‹ç™¼ä¸­`)
  }
}

// ç”Ÿå‘½é€±æœŸ
onMounted(async () => {
  await filesStore.fetchFiles()
  updateCategoryCounts()
})
</script>

<style scoped>
.category-management {
  padding: 2rem;
  max-width: 1200px;
  margin: 0 auto;
}

/* é é¢æ¨™é¡Œ */
.page-header {
  margin-bottom: 3rem;
  text-align: center;
}

.page-title {
  font-size: 2.5rem;
  font-weight: 300;
  color: var(--text-primary);
  margin-bottom: 0.5rem;
}

.page-subtitle {
  color: var(--text-secondary);
  font-size: 1.1rem;
}

/* åˆ†é¡ç³»çµ±å°æ¯” */
.classification-comparison {
  margin-bottom: 3rem;
}

.comparison-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2rem;
}

.classification-card {
  background: var(--bg-elevated);
  border-radius: var(--radius-xl);
  padding: 2rem;
  box-shadow: var(--shadow-lg);
  border: 1px solid var(--border-light);
}

.card-header {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 1px solid var(--border-light);
}

.card-header .icon {
  width: 2rem;
  height: 2rem;
  color: var(--color-primary);
}

.card-header h2 {
  font-size: 1.5rem;
  font-weight: 500;
  color: var(--text-primary);
}

.description {
  color: var(--text-secondary);
  margin-bottom: 1.5rem;
  font-size: 1rem;
}

.features h3,
.example-structure h3,
.category-list h3 {
  font-size: 1rem;
  font-weight: 500;
  color: var(--text-primary);
  margin-bottom: 0.75rem;
}

.features ul {
  list-style: none;
  padding: 0;
}

.features li {
  padding: 0.5rem 0;
  color: var(--text-secondary);
  position: relative;
  padding-left: 1.5rem;
}

.features li::before {
  content: 'â€¢';
  color: var(--color-primary);
  position: absolute;
  left: 0;
}

/* è³‡æ–™å¤¾æ¨¹ç‹€çµæ§‹ */
.folder-tree {
  background: var(--bg-secondary);
  border-radius: var(--radius-md);
  padding: 1rem;
  font-family: monospace;
  font-size: 0.875rem;
}

.folder {
  padding: 0.25rem 0;
  color: var(--text-primary);
}

.folder.level-1 {
  margin-left: 1rem;
}

.folder.level-2 {
  margin-left: 2rem;
  color: var(--text-secondary);
}

/* åˆ†é¡åˆ—è¡¨ */
.categories {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.category-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.75rem;
  background: var(--bg-secondary);
  border-radius: var(--radius-md);
  border: 1px solid var(--border-light);
}

.category-info {
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
}

.category-name {
  font-weight: 500;
  color: var(--text-primary);
}

.category-count {
  font-size: 0.875rem;
  color: var(--text-secondary);
}

.view-btn {
  padding: 0.5rem 1rem;
  background: var(--color-primary);
  color: white;
  border: none;
  border-radius: var(--radius-md);
  cursor: pointer;
  font-size: 0.875rem;
  transition: background var(--duration-fast) var(--ease-smooth);
}

.view-btn:hover {
  background: var(--color-primary-dark);
}

/* æ“ä½œæŒ‰éˆ• */
.actions {
  margin-top: 1.5rem;
  display: flex;
  gap: 1rem;
}

.action-btn {
  padding: 0.75rem 1.5rem;
  border: none;
  border-radius: var(--radius-md);
  cursor: pointer;
  font-weight: 500;
  transition: all var(--duration-fast) var(--ease-smooth);
}

.action-btn.primary {
  background: var(--color-primary);
  color: white;
}

.action-btn.primary:hover {
  background: var(--color-primary-dark);
}

.action-btn.secondary {
  background: var(--bg-tertiary);
  color: var(--text-primary);
  border: 1px solid var(--border-medium);
}

.action-btn.secondary:hover {
  background: var(--bg-secondary);
}

/* å»ºè­°ç­–ç•¥ */
.recommendation-section {
  background: var(--bg-elevated);
  border-radius: var(--radius-xl);
  padding: 2rem;
  box-shadow: var(--shadow-md);
}

.recommendation-section h2 {
  font-size: 1.75rem;
  font-weight: 500;
  color: var(--text-primary);
  margin-bottom: 1.5rem;
  text-align: center;
}

.strategy-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1.5rem;
}

.strategy-card {
  background: var(--bg-secondary);
  border-radius: var(--radius-lg);
  padding: 1.5rem;
  border: 1px solid var(--border-light);
}

.strategy-card h3 {
  font-size: 1.125rem;
  font-weight: 500;
  color: var(--text-primary);
  margin-bottom: 0.75rem;
}

.strategy-card p {
  color: var(--text-secondary);
  margin-bottom: 1rem;
}

.strategy-card ul {
  list-style: none;
  padding: 0;
}

.strategy-card li {
  padding: 0.25rem 0;
  color: var(--text-tertiary);
  font-size: 0.875rem;
  position: relative;
  padding-left: 1rem;
}

.strategy-card li::before {
  content: 'â†’';
  color: var(--color-primary);
  position: absolute;
  left: 0;
}

/* éŸ¿æ‡‰å¼è¨­è¨ˆ */
@media (max-width: 1024px) {
  .comparison-grid {
    grid-template-columns: 1fr;
  }
  
  .strategy-grid {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 768px) {
  .category-management {
    padding: 1rem;
  }
  
  .actions {
    flex-direction: column;
  }
}
</style>